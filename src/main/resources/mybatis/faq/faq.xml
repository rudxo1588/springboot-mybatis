<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.demo.faq.mapper.FaqMapper">
	
	<resultMap type="FaqVo" id="getDetailMap" autoMapping="true">
		<id column="faq_seq" property="faqSeq" />
		<collection property="faqImgList" column="faq_seq" select="getImgDetail" ofType="FaqImgVo" />
	</resultMap>
	
	<select id="getList" resultType="FaqVo">
		select
			*
		from 
			faq
		where
			faq_del_yn = 'N'
		<if test="faqTitle != null and !''.equals(faqTitle)">
			AND faq_title like CONCAT('%',#{faqTitle},'%')
		</if>
		<if test="faqContent != null and !''.equals(faqContent)">
			AND faq_Content like CONCAT('%',#{faqContent},'%')
		</if>
	</select>
	
	<insert id="insert" parameterType="FaqVo" useGeneratedKeys="true" keyProperty="faqSeq">
		insert into
		faq
		(faq_title, faq_content, faq_del_yn)
		values
		(#{faqTitle}, #{faqContent}, 'N')
	</insert>
	
	<update id="delete" parameterType="String">
		update 
			faq
		set 
			faq_del_yn = 'Y'
		where 
			faq_seq = #{faqSeq}
	</update>
	
	<update id="update" parameterType="FaqVo">
		update 
			faq
		set 
			faq_title = #{faqTitle}
			, faq_content = #{faqContent}
		where 
			faq_seq = #{faqSeq}
	</update>
	
	<select id="getDetail" resultMap="getDetailMap">
		select
			*
		from faq
		where faq_seq = #{faqSeq}	
	</select>
	
	<select id="getImgDetail" resultType="FaqImgVo">
		select
			*
		from faq_img
		where faq_seq = #{faqSeq}
		and del_yn = 'Y'
	</select>
</mapper>